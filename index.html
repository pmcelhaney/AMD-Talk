<!--
Review: Why IIFEs (Show how scoped variables work)
An IIFE that adds to the host object (window.myModule)
And IIFE that adds to a custom namespace (CLTJS.myModule)
-> Problem: Collisions are still possible
-> Problem: Tight coupling. Can't swap to a different module
Solution: 
  (function (module1, module2) { ... }(CLTS.module1, CTLJS.module2)}
  (function (module1, module2) { ... }(CLTS.moduleX, CTLJS.moduleY)}
  (function ($, stockQuoteFinder) { ... }(jQuery, CLTS.YqlStockQuoteFinder)) // make it concrete
-> Problem: Now you have local names a the top and global names at the bottom
Solution:
   define([jQuery, CLTJS.YqlStockQuoteFinder], function ($, stockQuoteFinder) {
    ...
   });
   
   function define(dependencies, iife) {
        iife.call(dependencies);
   }
   
Now dependencies are declared at the top. 
... Looks an awful lot like require from Ruby
... or import from Java.
   
What if we expand this define function to automatically "import" the required scripts?
1. Instead of a reference to module (it doesn't exist yet), we specify its name.
   define(['jQuery', 'YqlStockQuoteFinder'], ...)
2. Each module has to have a name.
   define('myModule', ...)
3. Each module defines one object.
   return { ... }
   
This is what AMD looks like.

A concrete example.

Back to abstract example. 
- The name is optional. 
- The dependencies are also optional
- return is also optional

The basic form of AMD:
define(name?, dependencies?, definitionFunction)

Real example that returns an object
Real example that returns an array
Real example that returns a function
Real example that returns a string

* * * * 

Concatenation with r.js

Using almond shim in production


* * * *

Plugins!

require, exports, module

require does this...
exports does this...
module does this...


   
   
  


-->

<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Asynchronous Module Definitions</title>
    
    <meta name="viewport" content="width=1024, user-scalable=no">
    
    <!-- Core and extension CSS files -->
    <link rel="stylesheet" href="deckjs/core/deck.core.css">
    <link rel="stylesheet" href="deckjs/extensions/goto/deck.goto.css">
    <link rel="stylesheet" href="deckjs/extensions/menu/deck.menu.css">
    <link rel="stylesheet" href="deckjs/extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" href="deckjs/extensions/status/deck.status.css">
    <link rel="stylesheet" href="deckjs/extensions/hash/deck.hash.css">
    
    
    <!-- Theme CSS files (menu swaps these out) -->
    <link rel="stylesheet" id="style-theme-link" href="deckjs/themes/style/web-2.0.css">
    <link rel="stylesheet" id="transition-theme-link" href="deckjs/themes/transition/fade.css">
    
    <!-- Custom CSS just for this page -->
    <link rel="stylesheet" href="deckjs/introduction/introduction.css">
    
    <script src="deckjs/modernizr.custom.js"></script>

    
</head>

<body class="deck-container">


<section class="slide" id="title-slide">
    <h1>Asynchronous Module Definition (AMD)</h1>
</section>


<section class="slide">
    <h2>History</h2>
    <ul>
        <li class="slide">James Burke (Dojo, etc.) [add photo]</li>
        <li class="slide">RequireJS</li>
        <li class="slide">AMD</li>
        <li class="slide">Curl, Yabble, PINF, etc.</li>    
    </ul>

</section>

<section class="slide">
    <h2>3 Problems</h2>
    <p>(2012 calendar)</p>
</section>

<section class="slide">
    <h2>Global Pollution</h2>
    <p>(Al Gore)</p>
</section>

<section class="slide">
    <h2>Script Size</h2>
    <p>(Megablock)</p>
</section>

<section class="slide">
    <h2>Too many scripts</h2>
    <p>(img of lots of script tags)</p>
</section>


<section class="slide">
<h2>Scopes</h2>

<pre>
    
    var name = "Stewart";
    
    var vampire = function () {
        var name = "Pattison";
        console.log(name);
    };
    
    var wolf = function () {
        var name = "Lautner";
        console.log(name);
    };
    
    var human = function () {
        console.log(name);
    };
</pre>

</section>


<section class="slide" id="iife-review">
    <h2>IIFE</h2>

    <h3>Immediately Invoked Function Expression</h3>

    <pre>
<strong>(function () {</strong>
    var a = "foo", b = "bar";
    ...

<strong>})();</strong>
    </pre>

</section>

<section class="slide" id="iife-with-global">
    <h2>IIFE</h2>
    
    <h3>Immediately Invoked Function Expression</h3>
    
    <pre>
(function () {
    var a = "foo", b = "bar";
    ...
    
    <strong>window.myModule = { ... };</strong>
})();
    </pre>  

</section>



<section class="slide" id="iife-with-namespace">
    <h2>IIFE</h2>
    
    <h3>Immediately Invoked Function Expression</h3>
    
<pre>
(function () {
    var a = "foo", b = "bar";
    ...

    <strong>CLTJS</strong>.myModule = { ... };
})();
</pre>

</section>


<section class="slide" id="iife-arguments">
    <h2>Solution</h2>
    
    <pre>
        
(function (<strong>moduleA, moduleB</strong>) {

    ...

})(<strong>CLTJS.moduleA, CLTS.moduleB</strong>);
        
        
    </pre>  
</section>




<section class="slide" id="iife-arguments">
    <h2>Solution</h2>
    
    <pre>
        
(function (moduleA, moduleB) {

    ...
    
})(CLTJS.module<strong>X</strong>, CLTS.module<strong>Y</strong>);
        
        
    </pre>  
</section>


<section class="slide" id="iife-arguments">
    <h2>Solution</h2>
    
    <pre>
        
(function (<strong>$, quoteLookup</strong>) {

    ...
    
})(<strong>jQuery, CLTS.quoteLookupFromYQL</strong>);
        
        
    </pre>  
</section>

<section class="slide">
<h2>Problem</h2>    
    
<p>Now you have local names a the top and global names at the bottom.</p>    
    
</section>

<section class="slide" id="define-introduction">
<h2>Solution</h2>

<pre>
    define([jQuery, CLTJS.YqlStockQuoteFinder], function ($, stockQuoteFinder) {
     ...
    });

</pre>


<pre>
    function define(dependencies, iife) {
         iife.apply(dependencies);
    }    
</pre>


<p>
    Now dependencies are declared at the top. 
   <ul>
       <li>Looks an awful lot like require from Ruby</li>
       <li>or import from Java.</li>    
    </ul>
</p>
</section>


<section class="slide">

<pre>    
    What if we expand this define function to automatically "import" the required scripts?
    1. Instead of a reference to module (it doesn't exist yet), we specify its name.
       define(['jQuery', 'YqlStockQuoteFinder'], ...)
    2. Each module has to have a name.
       define('myModule', ...)
    3. Each module defines one object.
       return { ... }
</pre>    
    
</section>


<section class="slide">
    <h2>Define: The &lt;3 of AMD</h2>
    
    
    <pre>(an abstract example)</pre>
    
    <pre>(a concrete example)</pre>
</section>


<section class="slide">
    <h2>Define: The &lt;3 of AMD</h2>

    <pre>(an abstract example -- without optional name)</pre>

    <p>(Drop the name, then the dependencies, then the return, showing all are optional.)</p>
</section>


<section class="slide" id="define-signature">
    <h2>Define: The &lt;3 of AMD</h2>

    <pre>define(name?, dependencies?, definitionFunction)</pre>

    <p>(Drop the name, then the dependencies, then the return, showing all are optional.)</p>
</section>


<section class="slide" id="example-object">

    <pre>real example that returns an object</pre>

</section>

<section class="slide" id="example-array">

    <pre>real example that returns an array</pre>

</section>

<section class="slide" id="example-function">

    <pre>real example that returns a function</pre>

</section>

<section class="slide" id="example-string">

    <pre>real example that returns a string</pre>

</section>


<section class="slide" id="r-js">
    
    <h2>r.js</h2>
    
    <p>Explain how concatenation works</p>

</section>


<section class="slide" id="r-js">
    
    <h2>Almond</h2>
    
    <ul>
        <li>concatenated files</li>
        <li>xx kb</li>
        <li>production</li>    
    </ul>

</section>


<section class="slide" id="plugins">
    <h2>Plugins!</h2>
    
</section>


<section class="slide" id="require-exports-module">
    <h2>require, exports, module</h2>
    
    <p>(Using it with Node would be more interesting.)</p>

</section>

<section class="slide" id="libraries">
    <h2>require, exports, module</h2>
    
    <ul>
        <li>Plugins on wiki</li>
        <li>Dojo collection</li>
        <li>Miller's collection</li>
        <li>jQuery, underscore, etc.</li>
    </ul>

</section>





<section class="slide">
    <h2>.Next</h2>
    
    <h3>Me</h3>
    <ul>
        <li>PatrickMcElhaney.com</li>
        <li>@patrick_mc</li>
        <li>http://github.com/pmcelhaney</li>
        <li>http://ux.stackexchange.com/</li>
    </ul>
    
    <h3>AMD</h3>
    <ul>
        <!-- I should put avatars here -->
        <li>http://<strong>requirejs.org</strong>/docs/whyamd.html</li>
        <li>James Burke - @jrburke</li> 
        <li>Jonn Hann - @unscriptable (curl.js)</li>
        <li>https://groups.google.com/group/<strong>amd-implement</strong></li>
    </ul>
</section>







<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<p class="deck-status">
    <span class="deck-status-current"></span>
    /
    <span class="deck-status-total"></span>
</p>

<form action="." method="get" class="goto-form">
    <label for="goto-slide">Go to slide:</label>
    <input type="number" name="slidenum" id="goto-slide">
    <input type="submit" value="Go">
</form>

<a href="." title="Permalink to this slide" class="deck-permalink">#</a>


  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="deckjs/jquery-1.6.4.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="deckjs/core/deck.core.js"></script>
<script src="deckjs/extensions/menu/deck.menu.js"></script>
<script src="deckjs/extensions/goto/deck.goto.js"></script>
<script src="deckjs/extensions/status/deck.status.js"></script>
<script src="deckjs/extensions/navigation/deck.navigation.js"></script>
<script src="deckjs/extensions/hash/deck.hash.js"></script>

<!-- Specific to this page -->
<script type="text/javascript" charset="utf-8">
    $(function () {
        $.deck('.slide');
    });
</script>


</body>
</html>
